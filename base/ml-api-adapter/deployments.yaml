apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/name: ml-api-adapter-handler-notification
  name: ml-api-adapter-handler-notification
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: ml-api-adapter-handler-notification
  template:
    metadata:
      labels:
        app.kubernetes.io/name: ml-api-adapter-handler-notification
    spec:
      containers:
        - command:
            - node
            - src/handlers/index.js
            - handler
            - --notification
          env:
            - name: LOG_LEVEL
              value: info
            - name: LOG_FILTER
              value: error, warn, info
            - name: CSL_LOG_TRANSPORT
              value: console
            - name: EVENT_SDK_SIDECAR_DISABLED
              value: 'true'
          image: mojaloop/ml-api-adapter:v11.1.2
          imagePullPolicy: Always
          livenessProbe:
            httpGet:
              path: /health
              port: 3000
              scheme: HTTP
            initialDelaySeconds: 90
            periodSeconds: 15
          name: service
          ports:
            - containerPort: 3000
              protocol: TCP
          readinessProbe:
            httpGet:
              path: /health
              port: 3000
              scheme: HTTP
            initialDelaySeconds: 120
            periodSeconds: 15
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/name: ml-api-adapter-service
  name: ml-api-adapter-service
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: ml-api-adapter-service
  template:
    metadata:
      labels:
        app.kubernetes.io/name: ml-api-adapter-service
    spec:
      containers:
        - command:
            - node
            - src/api/index.js
          env:
            - name: LOG_LEVEL
              value: info
            - name: LOG_FILTER
              value: error, warn, info
            - name: CSL_LOG_TRANSPORT
              value: console
            - name: EVENT_SDK_SIDECAR_DISABLED
              value: 'true'
          image: mojaloop/ml-api-adapter:v11.1.2
          imagePullPolicy: Always
          livenessProbe:
            httpGet:
              path: /health
              port: 3000
              scheme: HTTP
            initialDelaySeconds: 90
            periodSeconds: 15
          name: service
          ports:
            - containerPort: 3000
              protocol: TCP
          readinessProbe:
            httpGet:
              path: /health
              port: 3000
              scheme: HTTP
            initialDelaySeconds: 120
            periodSeconds: 15
